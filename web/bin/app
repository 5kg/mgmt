# -*- mode: ruby -*-
# vi: set ft=ruby :

if(File.exist?('/usr/mgmt'))
  %w(/usr/mgmt /usr/mgmt/lib).each {|p| $:.push p} 
else
  %w(. lib).each {|p| $:.push p}
end

require 'mgmt'

require 'jmx4r'

class JMX::MBean
  @@connection = java.lang.management.ManagementFactory.getPlatformMBeanServer()
end

t = Thread.new do 
  # Mgmt::Jmx.new.start_server
  Mgmt::App.run! 
end

if(Mgmt::Env.prod?)
  java_import com.cloudius.cli.main.RhinoCLI
  RhinoCLI.run(RhinoCLI::ConsoleTTY.new, true, [])
end

t.join
